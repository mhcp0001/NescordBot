---
description: 未コミットのファイルを確認し、適切な粒度でコミットを作成する
allowed-tools: [Bash, Read, Edit, TodoWrite]
---

# スマートコミット実行

未コミットのファイルを分析し、論理的に関連する変更を適切な粒度でコミットします。

## 実行手順

1. **作業計画の作成**
   - TodoWriteツールで必要な作業をリスト化
   - 品質チェック、コード整理、コミット準備の各ステップを明確化

2. **品質チェック（コミット前必須）**
   - プロジェクトで定義されている品質チェックを実行
   - 一般的な例:
     - Linter/Formatter (ESLint, Prettier, ktlint, rustfmt等)
     - 型チェック (TypeScript, Flow等)
     - テスト実行 (Jest, pytest, JUnit等)
   - `make lint`、`npm run check`などプロジェクト固有のコマンドを確認

3. **未コミット状況確認**
   - `git status`で変更されたファイルをリスト
   - `git diff --stat`で変更の統計情報を確認
   - `git diff`で具体的な変更内容を分析

4. **変更内容のグループ化**
   - 機能追加、バグ修正、リファクタリング、スタイル修正など論理的に分類
   - 関連するファイルをまとめてグループ化
   - 不要なデバッグコード・コメントの削除

5. **適切な粒度でコミット**
   - 各グループごとに独立したコミットを作成
   - Conventional Commits形式でメッセージ作成
   - 日本語で分かりやすい説明を追加
   - 1コミット = 1つの論理的変更の原則

6. **品質確保**
   - lefthookプレコミットフックが実行されることを確認
   - コミットメッセージ検証が通ることを確認
   - 最終的な`git status`でクリーンな状態を確認

7. **プロジェクトメモリ更新検討**
   - 作業中に発見した技術的課題・解決方法を CLAUDE.md に追加検討
   - 新しいエラーパターン、ライブラリ使用方法、設定の注意点等
   - 将来の開発効率化につながる知見の蓄積

## コミットメッセージ形式

```
<type>(<scope>): <subject>

<body>

🤖 Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>
```

## 実行例

```bash
# TodoWriteで作業計画
1. コードのLint/Format実行
2. 型チェック実行（該当する場合）
3. テスト実行
4. 不要なコメント・デバッグコードの削除
5. git status確認とコミット準備
6. プロジェクトメモリ更新の検討

# 品質チェック
✅ すべての品質チェックツールがパス

# コミット作成例
1. feat(auth): ユーザー認証機能を追加
2. fix(api): レスポンスヘッダーの不具合を修正
3. refactor(utils): 共通ユーティリティ関数を整理
4. test: 認証機能のユニットテストを追加
5. docs: APIドキュメントを更新
6. chore: 開発環境の設定ファイルを更新
```

## 注意事項

- **必ず品質チェックを実施**してからコミット
- テストが失敗している場合は、関連するテストか確認
- エラーや警告は可能な限り解消してからコミット
- パスに特殊文字が含まれる場合は適切にエスケープ
- プロジェクト固有のビルドツールやコマンドを確認（Makefile、package.json、build.gradle等）

**動作を開始します...**
